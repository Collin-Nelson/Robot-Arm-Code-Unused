#include "../include/configuration.h"
#include "../include/controller.h"
#include "../include/limitSwitch.h"
#include "../include/stepper.h"

#include <AccelStepper.h>
#include <Arduino.h>
#include <SPI.h>

//AXIS_1_INIT(axis1)
//AXIS_2_INIT(axis2)
//CONTROLLER_INIT(driver, axis1, axis2)

int limitPins[DOF] = {END_STOP_PIN_1, END_STOP_PIN_2};

void setup()
{
    Serial.begin(BAUDRATE);
    for (int i = 0; i < DOF; i++) {
        pinMode(limitPins[i], INPUT);
    }
}

void loop()
{
    testLimitSwitchs(1000, 10, limitPins);
}

/*
#include "../lib/teensy4_i2c-master/src/i2c_register_slave.h"
#include <Arduino.h>

struct data {
    uint32_t value;
};

struct steps {
    uint32_t axis1;
    uint32_t axis2;
    uint32_t axis3;
    uint32_t axis4;
    uint32_t axis5;
    uint32_t axis6;
};

volatile bool led_high = false;

data dataRegister;
steps stepRegister = { 500, 0, 0, 0, 0, 0 };
I2CRegisterSlave registerSlave = I2CRegisterSlave(Slave1, (uint8_t*)&stepRegister, sizeof(stepRegister), (uint8_t*)&dataRegister, sizeof(dataRegister));

void setup()
{
    pinMode(LED_BUILTIN, OUTPUT);
    // Start listening
    registerSlave.listen(0x20);

    // Enable the serial port for debugging
    Serial.begin(250000);
}

void loop()
{
    delay(stepRegister.axis1);

    digitalWrite(LED_BUILTIN, led_high);
    led_high = !led_high;
}
*/

